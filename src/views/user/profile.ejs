<%- include('../layouts/main', { body: `
<div class="max-w-2xl mx-auto space-y-6">
  <h1 class="text-2xl font-bold text-gray-900">My Profile</h1>

  <!-- Profile Info Card -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <div class="flex items-center mb-6">
      ${profile.avatar ? `
      <img src="${profile.avatar}" alt="Avatar" class="w-16 h-16 rounded-full">
      ` : `
      <div class="w-16 h-16 rounded-full bg-primary-100 flex items-center justify-center">
        <span class="text-2xl font-bold text-primary-600">${profile.name.charAt(0).toUpperCase()}</span>
      </div>
      `}
      <div class="ml-4">
        <h2 class="text-xl font-semibold text-gray-900">${profile.name}</h2>
        <p class="text-gray-500">${profile.email}</p>
        <span class="inline-flex items-center mt-1 px-2.5 py-0.5 rounded-full text-xs font-medium 
          ${profile.membershipType === 'C' ? 'bg-purple-100 text-purple-800' : 
            profile.membershipType === 'B' ? 'bg-blue-100 text-blue-800' : 
            'bg-gray-100 text-gray-800'}">
          ${profile.membershipType === 'C' ? 'Unlimited' : profile.membershipType === 'B' ? 'Premium' : 'Basic'} Member
        </span>
      </div>
    </div>

    <div class="border-t border-gray-200 pt-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">Update Profile</h3>
      
      ${typeof errors !== 'undefined' && errors.length > 0 ? `
      <div class="mb-4 rounded-md bg-red-50 p-4">
        <ul class="list-disc list-inside text-sm text-red-700">
          ${errors.map(err => '<li>' + err.msg + '</li>').join('')}
        </ul>
      </div>
      ` : ''}

      <form action="/user/profile" method="POST" class="space-y-4">
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
          <input 
            type="text" 
            id="name" 
            name="name" 
            value="${profile.name}"
            required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
          >
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input 
            type="email" 
            value="${profile.email}"
            disabled
            class="w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-500"
          >
          <p class="mt-1 text-xs text-gray-500">Email cannot be changed</p>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Login Provider</label>
          <input 
            type="text" 
            value="${profile.provider.charAt(0).toUpperCase() + profile.provider.slice(1)}"
            disabled
            class="w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-500"
          >
        </div>

        <button 
          type="submit" 
          class="w-full py-3 px-4 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 transition-colors"
        >
          Update Profile
        </button>
      </form>
    </div>
  </div>

  <!-- Change Password (only for local users) -->
  ${profile.provider === 'local' ? `
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Change Password</h3>
    
    <form action="/user/password" method="POST" class="space-y-4">
      <div>
        <label for="currentPassword" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
        <input 
          type="password" 
          id="currentPassword" 
          name="currentPassword" 
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
        >
      </div>

      <div>
        <label for="newPassword" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
        <input 
          type="password" 
          id="newPassword" 
          name="newPassword" 
          required
          minlength="6"
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
        >
        <p class="mt-1 text-xs text-gray-500">Minimum 6 characters</p>
      </div>

      <div>
        <label for="confirmNewPassword" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
        <input 
          type="password" 
          id="confirmNewPassword" 
          name="confirmNewPassword" 
          required
          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
        >
      </div>

      <button 
        type="submit" 
        class="w-full py-3 px-4 bg-gray-800 text-white font-medium rounded-lg hover:bg-gray-900 transition-colors"
      >
        Change Password
      </button>
    </form>
  </div>
  ` : `
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-2">Password</h3>
    <p class="text-gray-500 text-sm">
      You signed up using ${profile.provider.charAt(0).toUpperCase() + profile.provider.slice(1)}. 
      Password management is handled by your ${profile.provider.charAt(0).toUpperCase() + profile.provider.slice(1)} account.
    </p>
  </div>
  `}

  <!-- Account Info -->
  <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Account Information</h3>
    <dl class="space-y-3">
      <div class="flex justify-between">
        <dt class="text-gray-500">Member Since</dt>
        <dd class="text-gray-900 font-medium">
          ${new Date(profile.createdAt).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
        </dd>
      </div>
      <div class="flex justify-between">
        <dt class="text-gray-500">Account Status</dt>
        <dd>
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
            Active
          </span>
        </dd>
      </div>
    </dl>
  </div>
</div>
` }) %>
